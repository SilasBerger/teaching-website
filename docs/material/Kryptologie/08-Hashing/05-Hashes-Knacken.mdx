---
page_id: 0c192ec1-290b-4267-aec9-1f4c2d6f319a
---
import HashSHA2 from "@site/src/components/visualization-tools/cryptology/HashSHA2";

# Hashes knacken und w√ºrzen üßÇ
Kryptographische Hashfunktion wie [SHA2](https://de.wikipedia.org/wiki/SHA-2) sind also so konstruiert, dass man aus dem Hashwert nicht auf den urspr√ºnglichen Eingabewert (z.B. das Passwort) schliessen kann. Doch ist das wirklich so einfach?

Schauen Sie sich beispielsweise folgenden Ausschnitt aus einer Benutzerdatenbank an:

| Benutzername | Passwort-Hash (SHA2)                                             |
|--------------|------------------------------------------------------------------|
| bob          | ca167011d78e1241518bc68ee56176b993b7f1967095d4ebe5bc70f72f89f56b |
| alice        | e4ad93ca07acb8d908a3aa41e920ea4f4ef4f26e7f86cf8291c5db289780a5ae |
| charlie      | e4ad93ca07acb8d908a3aa41e920ea4f4ef4f26e7f86cf8291c5db289780a5ae |
| tammy        | 3700adf1f25fab8202c1343c4b0b4e3fec706d57cad574086467b8b3ddf273ec |
| sue          | c8f0bb8290089184ffeb3317f1c3185c7ffce3f442e6c2c97e4de489e8f231a5 |

:::aufgabe[Was f√§llt Ihnen auf?]
Was f√§llt Ihnen in dieser Tabelle auf? Wie k√∂nnten Sie diese Erkenntnis unter Umst√§nden nutzen, um doch auf das urspr√ºngliche Passwort zu schliessen?

Diskutieren Sie zu zweit und vergleichen Sie anschliessend mit der Musterl√∂sung unten.

<details>
  <summary>Musterl√∂sung</summary>
  <div>
    <h3>Was f√§llt auf?</h3>
    `alice` und `charlie` haben einen identischen Passwort-Hash. Kryptographische Hashfunktion wie SHA2 sind allerdings _kollisionsresistent_. Das bedeutet, dass zwei unterschiedliche Passw√∂rter mit gr√∂sster Wahrscheinlichkeit auch zwei unterschiedliche Hashwerte erzeugen. Im Umkehrschluss heisst das: `alice` und `charlie` verwenden h√∂chstwahrscheinlich dasselbe Passwort.
    <br/>

    <h3>Wie k√∂nnte man das ausnutzen?</h3>
    Wenn wir es irgendwie schaffen, an das Passwort von `alice` oder `charlie` zu gelangen, dann kennen wir auch gleich das Passwort der jeweils anderen Person. Zudem liegt die Vermutung nahe, dass die beiden vermutlich ein h√§ufig verwendetes Passwort gew√§hlt haben. Die Chance ist also gross, dass wir diesen Passwort-Hash auch noch bei weiteren Benutzern oder in anderen Datenbanken finden werden, und somit auch dort jeweils das Passwort kennen.
  </div>
</details>
:::

## Rainbow Tables
Fassen wir zusammen:
- Gleiche Passw√∂rter f√ºhren zu gleichen Hashes (jedenfalls unter Verwendung derselben Hashfunktion).
- Wenn wir f√ºr einen bestimmten Hash das dazugeh√∂rige Passwort kennen, dann ist die Kenntnis des Hashwerts genauso n√ºtzlich wie die Kenntnis des Passworts.

Aus der Sicht eines Angreifers ist damit folgende Strategie interessant:
1. Wir nehmen eine Liste von h√§ufig verwendeten Passw√∂rtern, zum Beispiel von [Wikipedia](https://en.wikipedia.org/wiki/Wikipedia:10,000_most_common_passwords).
2. Wir berechnen f√ºr jedes Passwort den entsprechenden Hash mit einer h√§ufig verwendeten Hashfunktion (z.B. SHA2) und erstellen daraus eine Tabelle.
3. Wenn wir an eine Datenbank mit _gehashten_ Passw√∂rtern gelangen, dann suchen wir f√ºr jeden Hash in der Datenbank den passenden Eintrag in unserer Tabelle.
4. Wenn der Benutzer ein sicheres Passwort verwendet, dann haben wir Pech gehabt ‚Äî wir werden in unserer Tabelle dazu keinen Hash finden. Wenn er aber ein h√§ufig verwendetes Passwort gew√§hlt hat, dann taucht der Hash in unserer Tabelle auf und wir kennen sein Passwort.

Eine solche Passwort-Hash-Tabelle bezeichnen wir als **Rainbow Table**. Wir m√ºssen sie auch nicht selbst erstellen, denn man findet sie problemlos im Internet. Es gibt sogar Online-Tools, mit denen man einen Passwort-Hash in einer solchen _Rainbow Table_ nachschlagen kann.

:::aufgabe[Hashes knacken]
Alle Benutzer in der obigen Benutzerdatenbank haben ein unsicheres, h√§ufig verwendetes Passwort gew√§hlt: jeder dieser Passwort-Hashes ist in den einschl√§gigen _Rainbow Tables_ zu finden.

1. Verwenden Sie das Online-Tool [CrackStation](https://crackstation.net/) um die Passw√∂rter von `alice` und `charlie` sowie `bob` herauszufinden (siehe Tabelle ganz oben).
2. √úberlegen Sie sich ein weiteres Passwort, von dem Sie glauben, dass es mit _CrackStation_ geknackt werden kann. Verwenden Sie das untenstehende Hashing-Tool um dessen SHA2-Hashwert zu berechnen, welchen Sie dann bei _CrackStation_ √ºberpr√ºfen k√∂nnen.
3. √úberlegen Sie sich nun auch noch ein Passwort, von dem Sie glauben, dass es auf keiner _Rainbow Table_ erscheint. Verwenden Sie wiederum das Hash-Tool und _CrackStation_ um Ihre Vermutung zu pr√ºfen.

<HashSHA2 />
:::

## Hashes w√ºrzen
Entwickler verwenden zwei wichtige Strategien, um ihre Benutzer im Falle eines Datenlecks vor der Verwendung von Rainbow Tables zu sch√ºtzen: **Salts** und **Peppers**. Diese beiden Konzepte werden im folgenden Video erkl√§rt:
::youtube[https://www.youtube.com/embed/--tnZMuoK3E?si=bphabzB78ZbBYTAi&amp;start=117]

:::aufgabe[Passw√∂rter salzen]
Sie kennen bereits die Passw√∂rter von `alice`, `charlie` und `tammy`. Nun wechseln Sie von der b√∂sen auf die gute Seite.

Legen Sie einen beliebigen _Salt_ fest und erstellen Sie anschliessend eine neue Benutzertabelle mit Eintr√§gen f√ºr diese User. Verwenden Sie beim Hashen der Passw√∂rter diesmal aber den gew√§hlten _Salt_. √úberpr√ºfen Sie dann nochmal mit [CrackStation](https://crackstation.net/), ob die Benutzer jetzt wirklich gegen die Verwendung von Rainbow Tables gesch√ºtzt sind.

<HashSHA2 />
:::

---
